<!DOCTYPE html>
<html>

<head>
    <!-- Hotjar Tracking Code for Site 6502468 (name missing) -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:6502468,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0TGSSCQM2C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0TGSSCQM2C');
</script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <meta charset="utf-8">
    <title>Build Your Own 2048</title>
  <meta property="og:title" content="Build Your Own 2048" />
  <meta property="og:description" content="Custom 2048 game tiles" />
  <meta property="og:url" content="https://yborsk.github.io/buildyourown2048/" />
  <meta property="og:type" content="website" />
    <link href="style/main.css" rel="stylesheet" type="text/css">
    <link rel="apple-touch-icon" sizes="180x180" href="/makeurown/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/makeurown/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/makeurown/icon/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/makeurown/icon/favicon-16x16.png">
    <link rel="manifest" href="/makeurown/icon/site.webmanifest">
    <link rel="mask-icon" href="/makeurown/icon/safari-pinned-tab.svg" color="#515151">
    <link rel="shortcut icon" href="/makeurown/icon/favicon.ico">
    <meta name="msapplication-TileColor" content="#9f00a7">
    <meta name="msapplication-TileImage" content="/makeurown/icon/mstile-144x144.png">
    <meta name="msapplication-config" content="/makeurown/icon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">
</head>

<body>
    <div class="container">
            
            <div class="heading">
                <h1 class="title">2048</h1>
                <div class="scores-container">
                    <div class="score-container">0</div>
                    <div class="best-container">0</div>
                </div>
            </div>

            <div class="above-game">
                <p class="game-intro">Join the numbers and get to the <strong>2048 tile!</strong></p>
                <a class="restart-button">New Game</a>
                <!-- <a class="save-button">Save</a> -->
                <!-- Dark mode toggle -->
                <div class="dark-mode-toggle" style="float:right; display:flex; align-items:center; gap:8px; margin-top:8px;">
                  <span id="theme-label" style="font-size:13px; opacity:.85;">Light</span>
                  <label class="switch">
                    <input id="theme-switch" type="checkbox" aria-label="Toggle dark mode">
                    <span class="slider"></span>
                  </label>
                </div>
                <!-- Highest-tile background toggle -->
<div class="bg-toggle" style="float:right; display:flex; align-items:center; gap:8px; margin-top:8px; margin-right:12px;">
  <span id="bg-label" style="font-size:13px; opacity:.85;">BG: On</span>
  <label class="switch">
    <input id="bg-highest-switch" type="checkbox" aria-label="Use highest tile as background" checked>
    <span class="slider"></span>
  </label>
</div>
            </div>

            <div class="game-container">
                <div class="game-message">
                    <p></p>
                    <div class="lower">
                        <a class="keep-playing-button">Keep going</a>
                        <a class="retry-button">Try again</a>
                    </div>
                </div>
                 <div class="restore-message">
                    <div class="restore-hide">
                        <p>You have already started a game on another device, would you like to continue the old game, or start a new one? <strong>WARNING: You will loose your old game if you start a new one.</strong></p>
                        <a class="continue-button">Continue</a>
                        <a class="start-new-button">Start New</a>
                    </div>
                </div>
                <div class="login-hide">
                    <div class="lower-hide">
                        <p class="paused-button"><strong>Game Paused</strong><br><a class="unpause">Unpause</a></p>
                    </div>
                </div>
                <div class="grid-container">
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                </div>

                <div class="tile-container">

                </div>
            </div>
        <div class="heading">
            <h2 style="text-align:center;">You are playing:</h2>
                <div id="custom-name" style="text-align:center;font-weight:600;font-size:20px;margin:6px 0;display:none;"></div>
        </div>

            
        <!-- removed tile key for now
        <h1>Tile Key</h1>
        <p>This is a key that shows you which images represent specific numbers in 2048, it updates when you change the game.</p>
        <p><strong>Tile #2</strong></p><div class="tile-inner2"></div>
        <br>
        <p><strong>Tile #4</strong></p><div class="tile-inner4"></div>
        <br>
        <p><strong>Tile #8</strong></p><div class="tile-inner8"></div>
        <br>
        <p><strong>Tile #16</strong></p><div class="tile-inner16"></div>
        <br>
        <p><strong>Tile #32</strong></p><div class="tile-inner32"></div>
        <br>
        <p><strong>Tile #64</strong></p><div class="tile-inner64"></div>
        <br>
        <p><strong>Tile #128</strong></p><div class="tile-inner128"></div>
        <br>
        <p><strong>Tile #256</strong></p><div class="tile-inner256"></div>
        <br>
        <p><strong>Tile #512</strong></p><div class="tile-inner512"></div>
        <br>
        <p><strong>Tile #1024</strong></p><div class="tile-inner1024"></div>
        <br>
        <p><strong>Tile #2048</strong></p><div class="tile-inner2048"></div>
        <hr>
        
            <h1> Change Images </h1>
        <div class="saved-games"></div>
            <div class="sam game-explanation container-flex">
                <br>
                <p> Image for 2 </p>
                <textarea class='input2' placeholder='www.starwars.com/darkvader.png'></textarea>
                <br>
                <p> Image for 4 </p>
                <textarea class='input4' placeholder='www.starwars.com/lukeskywalker.png'></textarea>
                <br>
                <p> Image for 8 </p>
                <textarea class='input8' placeholder='www.starwars.com/yoda.png'></textarea>
                <br>
                <p> Image for 16 </p>
                <textarea class='input16' placeholder='www.starwars.com/samtheevil.png'></textarea>
                <br>
                <p> Image for 32 </p>
                <textarea class='input32' placeholder='www.starwars.com/aidanthehacker.png'></textarea>
                <br>
                <p> Image for 64 </p>
                <textarea class='input64' placeholder='www.starwars.com/urmom.png'></textarea>
                <br>
                <p> Image for 128 </p>
                <textarea class='input128' placeholder='www.starwars.com/urdad.png'></textarea>
                <br>
                <p> Image for 256 </p>
                <textarea class='input256' placeholder='www.starwars.com/ursister1.png'></textarea>
                <br>
                <p> Image for 512 </p>
                <textarea class='input512' placeholder='www.starwars.com/ursister2.png'></textarea>
                <br>
                <p> Image for 1024 </p>
                <textarea class='input1024' placeholder='www.starwars.com/urbrother1.png'></textarea>
                <br>
                <p> Image for 2048 </p>
                <textarea class='input2048' placeholder='www.starwars.com/urbrother2_aidan_ur_awesome_sam_keep_doing_you.png'></textarea>
                <br>
                <p>Name this Game</p>
                <textarea class='nameGame' placeholder='star wars game'></textarea>
                <br>
                <a class="go">Submit</a>
                <br>
                <br>
            </div> -->
        </div>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:700,600' rel='stylesheet' type='text/css'>
        <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

 

        <script>
        </script>
        <script src="js/change.js"></script>
        <script src="js/bind_polyfill.js"></script>
        <script src="js/classlist_polyfill.js"></script>
        <script src="js/animframe_polyfill.js"></script>
        <script src="js/keyboard_input_manager.js"></script>
        <script src="js/html_actuator.js"></script>
        <script src="js/grid.js"></script>
        <script src="js/tile.js"></script>
        <script src="js/local_storage_manager.js"></script>
        <script src="js/game_manager.js"></script>
    <!-- after your other core scripts, but before application.js -->
<script src="js/url_theme.js"></script>
<script>
  // Read ?tile2=…&tile4=… etc. and store in window.customTileImages
  window.UrlTheme && window.UrlTheme.applyFromLocation();
</script>

<!-- keep the existing application startup after this -->
<script src="js/application.js"></script>

<script src="js/transparent_tiles.js"></script>

    <script>
(function () {
  var STORAGE_KEY = 'byo2048-bg-enabled';
  var container = document.querySelector('.game-container');
  var switchEl = document.getElementById('bg-highest-switch');
  var labelEl  = document.getElementById('bg-label');

  if (!container) return;

  // ----- helpers -----
  function getTileValueFrom(el) {
    // 2048 tiles have classes like: "tile tile-128 tile-position-..." etc.
    var cls = el.className || '';
    var m = cls.match(/(?:^|\s)tile-(\d+)(?:\s|$)/);
    return m ? parseInt(m[1], 10) : 0;
  }

  function getBgFromInner(innerEl) {
  // 1) If the user provided a URL for this tile value, use it first.
  var parentVal = getTileValueFrom(innerEl.parentElement || {});
  if (parentVal && window.customTileImages && window.customTileImages[parentVal]) {
    return 'url("' + window.customTileImages[parentVal] + '")';
  }

  // 2) Otherwise, fall back to whatever CSS gave this tile (the defaults)
  var s = window.getComputedStyle(innerEl);
  var bg = (s && s.backgroundImage) || '';
  return (bg && bg !== 'none') ? bg : '';
}


  function findHighestTileBg() {
    var inners = document.querySelectorAll('.tile-container .tile .tile-inner');
    var best = { val: 0, bg: '' };
    inners.forEach(function (inner) {
      var val = getTileValueFrom(inner.parentElement || inner);
      if (val >= best.val) {
        var bg = getBgFromInner(inner);
        if (bg) best = { val: val, bg: bg };
      }
    });
    return best.bg; // css url("...") or ''
  }

  function applyBackground() {
    if (!container.classList.contains('byobg-on')) return;
    var bg = findHighestTileBg();
    // If nothing found, clear image but keep gray overlay subtle
    container.style.setProperty('--byo-bg-image', bg || 'none');
  }

  function setEnabled(on) {
    if (on) {
      container.classList.add('byobg-on');
      if (labelEl) labelEl.textContent = 'BG: On';
      try { localStorage.setItem(STORAGE_KEY, '1'); } catch (e) {}
      applyBackground();
    } else {
      container.classList.remove('byobg-on');
      if (labelEl) labelEl.textContent = 'BG: Off';
      container.style.removeProperty('--byo-bg-image');
      try { localStorage.setItem(STORAGE_KEY, '0'); } catch (e) {}
    }
  }

  // ----- init (default ON) -----
  var saved = null;
  try { saved = localStorage.getItem(STORAGE_KEY); } catch (e) {}
  var enabled = (saved === null) ? true : saved === '1';

  if (switchEl) {
    switchEl.checked = enabled;
    switchEl.addEventListener('change', function () { setEnabled(switchEl.checked); });
  }
  setEnabled(enabled);

  // Update whenever tiles change (moves, merges, new game)
  var tileWrap = document.querySelector('.tile-container');
  if (tileWrap) {
    var pending = false;
    var obs = new MutationObserver(function () {
      if (!enabled) return;
      if (pending) return;
      pending = true;
      requestAnimationFrame(function () {
        pending = false;
        applyBackground();
      });
    });
    obs.observe(tileWrap, { childList: true, subtree: true, attributes: true, attributeFilter: ['class', 'style'] });
  }

  // Also update after initial paint and after restart button
  window.addEventListener('load', applyBackground);
  document.addEventListener('keydown', function (e) {
    if (e.key === 'r' || e.key === 'R') setTimeout(applyBackground, 0);
  });

  // If your game exposes window.gameManager.restart, hook the click you already added
  // (Your existing code dispatches 'R' on restart clicks, which we already listen for.)
})();
</script>
    

  <!-- ===== Share / Link Generator (bottom of page) ===== -->
  <style>
    .share-section{max-width:720px;margin:24px auto 40px;padding:16px;border:1px solid #ddd;border-radius:8px;font-family:inherit}
    .share-grid{display:grid;grid-template-columns:80px 1fr;gap:8px 12px;align-items:center}
    .share-row{display:contents}
    .share-row input[type="text"]{width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;font-family:inherit}
    .share-output{display:flex;gap:8px;margin-top:12px}
    .share-output input{flex:1;padding:8px;border:1px solid #bbb;border-radius:4px;font-family:inherit}
    .share-actions{display:flex;gap:10px;align-items:center;margin-top:8px}
    .share-actions button{padding:6px 10px;border:1px solid #888;border-radius:4px;background:#f7f7f7;cursor:pointer}
    .share-actions a{word-break:break-all}
    .share-heading{font-weight:600;margin:0 0 8px}
    .share-sub{color:#666;margin:0 0 12px}
    @media (max-width:560px){.share-grid{grid-template-columns:1fr}.share-grid label{margin-top:8px}}
  </style>

  <div class="share-section">
      <p>
                <strong class="important">How to play:</strong> Use your <strong>arrow keys</strong> to move the tiles. When two tiles with the same picture touch, they <strong>merge into one!</strong>
            </p>
      <hr>
    <p class="share-heading">Create your own custom 2048 game</p>
    <p class="share-sub">Enter a name and direct image URLs for each tile. Scroll down for detailed instructions!</p>
    <form id="share-form" class="share-grid" onsubmit="return false;">
      <div class="share-row">
        <label for="share-name">Name</label>
        <input id="share-name" type="text" placeholder="e.g., My Cute Cats Set">
      </div>
      <!-- Tile URL fields -->
      <div class="share-row"><label for="url-2">tile2</label><input id="url-2" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-4">tile4</label><input id="url-4" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-8">tile8</label><input id="url-8" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-16">tile16</label><input id="url-16" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-32">tile32</label><input id="url-32" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-64">tile64</label><input id="url-64" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-128">tile128</label><input id="url-128" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-256">tile256</label><input id="url-256" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-512">tile512</label><input id="url-512" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-1024">tile1024</label><input id="url-1024" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-2048">tile2048</label><input id="url-2048" type="text" placeholder="https://..."></div>
       <!-- Show numbers (now a switch) -->
<div class="share-row">
  <label for="share-nums">Show tile numbers</label>
  <label class="switch">
    <input id="share-nums" type="checkbox" checked>
    <span class="slider"></span>
  </label>
</div>

<!-- Transparent tiles (new switch) -->
<div class="share-row">
  <label for="share-tt">
  </label>
  <label class="switch">
    <input id="share-tt" type="checkbox" aria-label="Transparent tiles">
    <span class="slider"></span>
  </label>
</div>

    </form>
    <div class="share-output">
      <input id="share-output" type="text" readonly>
      <button id="share-copy" type="button">Copy</button>
    </div>
        <hr>
    <div class="share-actions">
      <a id="share-anchor" href="#" target="_blank" rel="noopener">Open this custom game</a>
    </div>
      <hr>

<!-- Bulk Paste Section -->
    <div class="share-bulk">
      <label for="bulk-links" style="font-weight:600;">Paste all 11 tile image links (2 → 2048)</label>
      <textarea id="bulk-links" rows="5" style="width:100%;margin-top:6px;resize:vertical;overflow:auto;"
        placeholder="Paste each link on a new line&#10;First line = tile2, second = tile4, ... up to tile2048"></textarea>
      <div style="margin-top:8px;display:flex;gap:8px;">
        <button id="bulk-apply" type="button">Paste & Autofill</button>
        <button id="bulk-clear" type="button">Clear</button>
      </div>
      <div id="bulk-feedback" style="margin-top:6px;font-size:.9rem;color:#0a662f;"></div>
    </div>
      <hr>
      <section id="custom-2048-instructions">
  <h2><strong>How to create your own game</strong></h2>

  <ol>
    <li>
      Prepare 11 square images for tiles 2 through 2048.
      <ul>
        <li>Images can be static or animated (GIFs).</li>
        <li>Most video editing apps, like Capcut or Inshot, have the option to export videos as GIFs.</li>
        <li>Non-square images will be automatically cropped to a 1:1: ratio.</li>
        <li>For smooth loading, keep each one under 300 × 300 px or about 8MB.</li>
      </ul>
    </li>

    <li>
      <strong>Create an account</strong> at
      <a href="https://www.freeimage.host/" target="_blank" rel="noopener">freeimage.host</a>.
      <ul>
        <li>This is <strong>required</strong> for your images to save correctly.</li>
      </ul>
    </li>

    <li>
      <strong>Upload your images</strong> to
      <a href="https://www.freeimage.host/" target="_blank" rel="noopener">freeimage.host</a>.
      <ul>
        <li>You can upload all 11 at once (easiest), or one by one.</li>
        <li>If uploading all at once, select them in the order you want them to appear.</li>
      </ul>
    </li>

    <li>
      Copy the <strong>direct links</strong> for your images.
      <ul>
        <li>Do <strong>not</strong> use viewer links. Direct links look like: <code>https://iili.io/xxxxxx.png</code></li>
        <li>If you uploaded all 11 together, paste the list into the “Paste all 11 tile image links” box.</li>
        <li>If you uploaded them separately, paste each link into its matching tile box.</li>
      </ul>
    </li>

    <li>
      Enter a <strong>name for your game</strong> at the top.
    </li>
    <li>
        Choose whether or not to show numbers on the tiles (uncheck if your images already have numbers).
    </li>
      
    <li>
      Click “<strong>Open this custom game.</strong>”
      <ul>
        <li>Your custom 2048 is now ready!</li>
        <li>Don’t forget to <strong>save your link</strong> so you can play again later.</li>
      </ul>
    </li>
  </ol>

  <p><strong>Notes:</strong></p>
  <ul>
    <li>Any image host works, as long as you use direct image links.</li>
    <li>Game URLs are long, since all tile links are stored inside them.</li>
  </ul>
</section>
      
            <hr>
            <p>
                Edited by <a href="http://github.com/cdivry">Clément DIVRY</a> to make this game use pictures.
                <br /> Forked from a AidanSpeakss adaptation of a <a href="http://gabrielecirulli.com" target="_blank">Gabriele Cirulli</a> project hosted <a href="http://github.com/gabrielecirulli/2048">here</a>, Based on <a href="https://itunes.apple.com/us/app/1024!/id823499224" target="_blank">1024 by Veewo Studio</a> and conceptually similar to <a href="http://asherv.com/threes/" target="_blank">Threes by Asher Vollmer.</a>
            </p>
        
  </div>

  <script src="js/share_link.js"></script>

<script>
  (function () {
    function setDisplayName(name) {
      var box = document.getElementById('custom-name');
      if (!box) return;
      name = (name || '').trim();
      box.textContent = name;
      box.style.display = name ? 'block' : 'none';
    }

    // On load: read from ?name=
    var params = new URLSearchParams(location.search);
    setDisplayName(params.get('name'));

    // If you’re using the link generator UI, update live as the user types
    var nameInput = document.getElementById('share-name');
    if (nameInput) {
      nameInput.addEventListener('input', function () {
        setDisplayName(nameInput.value);
      });
    }
  })();
</script>

    <script>
  // When the "New Game" button is clicked, simulate pressing the "R" key
  document.addEventListener('click', function (e) {
    if (!e.target) return;
    // Change selectors if your button has a different class or ID
    if (
      e.target.matches('.retry-button') ||
      e.target.matches('.restart-button')
    ) {
      e.preventDefault();

      // Fire R key logic directly if available
      var gm = window.gameManager;
      if (gm && typeof gm.restart === 'function') {
        gm.restart(e);
        return;
      }

      // Otherwise, dispatch a keydown for 'R'
      var event = new KeyboardEvent('keydown', {
        key: 'r',
        keyCode: 82,
        code: 'KeyR',
        which: 82,
        bubbles: true,
      });
      document.dispatchEvent(event);
    }
  });
</script>

<script>
  (function () {
    var KEY = 'byo2048-theme';
    var checkbox = document.getElementById('theme-switch');
    var label = document.getElementById('theme-label');

    function applyTheme(mode) {
      document.documentElement.setAttribute('data-theme', mode);
      if (checkbox) checkbox.checked = (mode === 'dark');
      if (label) label.textContent = (mode === 'dark' ? 'Dark' : 'Light');
      try { localStorage.setItem(KEY, mode); } catch (e) {}
      // Also tint the browser UI for PWA-ish feel:
      var meta = document.querySelector('meta[name="theme-color"]');
      if (meta) meta.setAttribute('content', mode === 'dark' ? '#121212' : '#ffffff');
    }

    // On load: prefer stored theme; else prefers-color-scheme; else light
    var saved = null;
    try { saved = localStorage.getItem(KEY); } catch (e) {}
    var preferred = saved || (window.matchMedia &&
                    window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(preferred);

    if (checkbox) {
      checkbox.addEventListener('change', function () {
        applyTheme(checkbox.checked ? 'dark' : 'light');
      });
    }
  })();
</script>

<script>
  (function () {
    function fitBoardToViewport() {
      var root = document.documentElement;
      var board = document.querySelector('.game-container');
      if (!board) return;

      // Read current gutter (defaults to 8px if not set)
      var cs = getComputedStyle(root);
      var gutter = parseFloat(cs.getPropertyValue('--gutter')) || 8;

      var vw = window.innerWidth;
      var vh = window.innerHeight;

      // Distance from top of viewport to the top edge of the board (includes header/scores)
      var topToBoard = board.getBoundingClientRect().top;

      // Board must fit within width gutters AND the remaining vertical space
      var maxByWidth  = vw - gutter * 2;
      var maxByHeight = vh - topToBoard - gutter;

      // Guard against negatives; floor to whole pixels for crispness
      var size = Math.max(0, Math.min(maxByWidth, maxByHeight)) | 0;

      // Expose to CSS
      root.style.setProperty('--board-size-dyn', size + 'px');
    }

    // Run on load and on resize/orientation changes.
    window.addEventListener('resize', fitBoardToViewport, { passive: true });
    window.addEventListener('orientationchange', fitBoardToViewport);

    // Run after layout paints (handles webfonts / header wrapping)
    document.addEventListener('DOMContentLoaded', function () {
      fitBoardToViewport();
      // A couple of post-load passes to catch late layout shifts
      setTimeout(fitBoardToViewport, 0);
      setTimeout(fitBoardToViewport, 250);
      setTimeout(fitBoardToViewport, 1000);
    });
  })();
</script>

<script>
(function () {
  var root = document.documentElement;
  var params = new URLSearchParams(location.search);
  var checkbox = document.getElementById('share-nums');   // the “Show tile numbers” checkbox
  var out = document.getElementById('share-output');       // the Copy URL box
  var form = document.getElementById('share-form');
  var copyBtn = document.getElementById('share-copy');

  function setVisibility(show) {
    root.setAttribute('data-show-nums', show ? '1' : '0');
  }

  function setParamOnUrlString(urlString, show) {
    try {
      var u = new URL(urlString, location.origin);
      u.searchParams.set('nums', show ? '1' : '0');
      return u.toString();
    } catch (e) {
      return urlString; // if it's empty / not a full URL yet
    }
  }

  function updateOutField() {
    if (!out || !out.value) return;
    var show = checkbox ? checkbox.checked : true;
    out.value = setParamOnUrlString(out.value, show);
  }

  // Initialize from current URL (?nums=1/0) without changing the address bar
  var initial = params.get('nums');
  var show = (initial === null) ? true : initial !== '0';
  setVisibility(show);
  if (checkbox) checkbox.checked = show;

  // When user toggles the checkbox: just change visibility + the Copy URL box
  if (checkbox) {
    checkbox.addEventListener('change', function () {
      setVisibility(checkbox.checked);
      updateOutField();
    });
  }

  // If the form regenerates the share URL, re-apply the nums param to the output box
  if (form) {
    form.addEventListener('input', function () { setTimeout(updateOutField, 0); });
    form.addEventListener('change', function () { setTimeout(updateOutField, 0); });
  }

  // Right before copying, make sure the output box is up to date
  if (copyBtn) copyBtn.addEventListener('click', updateOutField);

  // One initial pass
  setTimeout(updateOutField, 0);
})();
</script>

<script>
(function () {
  const TILE_IDS = [2,4,8,16,32,64,128,256,512,1024,2048];

  function applyBulk() {
    const txt = document.getElementById('bulk-links').value.trim();
    const fb = document.getElementById('bulk-feedback');
    fb.textContent = '';
    fb.style.color = '#0a662f';

    if (!txt) {
      fb.textContent = 'Please paste some links.';
      fb.style.color = '#b00020';
      return;
    }

    // Split by newlines, trim, filter empties
    const links = txt.split(/\n+/).map(s => s.trim()).filter(Boolean);

    if (links.length < TILE_IDS.length) {
      fb.textContent = `You pasted ${links.length} / ${TILE_IDS.length} links. Need 11 total.`;
      fb.style.color = '#b00020';
      return;
    }

    TILE_IDS.forEach((id, i) => {
      const input = document.getElementById('url-' + id);
      if (input) {
        input.value = links[i] || '';
        // trigger input event so share_link.js updates the generated URL
        input.dispatchEvent(new Event('input', { bubbles: true }));
      }
    });

    fb.textContent = 'All links applied successfully ✅';
  }

  function clearBulk() {
    document.getElementById('bulk-links').value = '';
    document.getElementById('bulk-feedback').textContent = '';
  }

  document.addEventListener('DOMContentLoaded', function () {
    const applyBtn = document.getElementById('bulk-apply');
    const clearBtn = document.getElementById('bulk-clear');
    if (applyBtn) applyBtn.addEventListener('click', applyBulk);
    if (clearBtn) clearBtn.addEventListener('click', clearBulk);
  });
})();
</script>
    
</body>

</html>
