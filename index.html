<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <meta charset="utf-8">
    <title>Build Your Own 2048</title>
  <meta property="og:title" content="Build Your Own 2048" />
  <meta property="og:description" content="Custom 2048 game tiles" />
  <meta property="og:url" content="https://yborsk.github.io/buildyourown2048/" />
  <meta property="og:type" content="website" />
    <link href="style/main.css" rel="stylesheet" type="text/css">
    <link rel="apple-touch-icon" sizes="180x180" href="/makeurown/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/makeurown/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/makeurown/icon/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/makeurown/icon/favicon-16x16.png">
    <link rel="manifest" href="/makeurown/icon/site.webmanifest">
    <link rel="mask-icon" href="/makeurown/icon/safari-pinned-tab.svg" color="#515151">
    <link rel="shortcut icon" href="/makeurown/icon/favicon.ico">
    <meta name="msapplication-TileColor" content="#9f00a7">
    <meta name="msapplication-TileImage" content="/makeurown/icon/mstile-144x144.png">
    <meta name="msapplication-config" content="/makeurown/icon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">
</head>

<body>
    <div class="container">
            
            <div class="heading">
                <h1 class="title">2048</h1>
                <div class="scores-container">
                    <div class="score-container">0</div>
                    <div class="best-container">0</div>
                </div>
            </div>

            <div class="above-game">
                <p class="game-intro">Join the numbers and get to the <strong>2048 tile!</strong></p>
                <a class="restart-button">New Game</a>
                <!-- <a class="save-button">Save</a> -->
                <!-- Dark mode toggle -->
                <div class="dark-mode-toggle" style="float:right; display:flex; align-items:center; gap:8px; margin-top:8px;">
                  <span id="theme-label" style="font-size:13px; opacity:.85;">Light</span>
                  <label class="switch">
                    <input id="theme-switch" type="checkbox" aria-label="Toggle dark mode">
                    <span class="slider"></span>
                  </label>
                </div>
            </div>

            <div class="game-container">
                <div class="game-message">
                    <p></p>
                    <div class="lower">
                        <a class="keep-playing-button">Keep going</a>
                        <a class="retry-button">Try again</a>
                    </div>
                </div>
                 <div class="restore-message">
                    <div class="restore-hide">
                        <p>You have already started a game on another device, would you like to continue the old game, or start a new one? <strong>WARNING: You will loose your old game if you start a new one.</strong></p>
                        <a class="continue-button">Continue</a>
                        <a class="start-new-button">Start New</a>
                    </div>
                </div>
                <div class="login-hide">
                    <div class="lower-hide">
                        <p class="paused-button"><strong>Game Paused</strong><br><a class="unpause">Unpause</a></p>
                    </div>
                </div>
                <div class="grid-container">
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                </div>

                <div class="tile-container">

                </div>
            </div>
        <div class="heading">
            <h2 style="text-align:center;">You are playing:</h2>
                <div id="custom-name" style="text-align:center;font-weight:600;font-size:20px;margin:6px 0;display:none;"></div>
        </div>

            
        <!-- removed tile key for now
        <h1>Tile Key</h1>
        <p>This is a key that shows you which images represent specific numbers in 2048, it updates when you change the game.</p>
        <p><strong>Tile #2</strong></p><div class="tile-inner2"></div>
        <br>
        <p><strong>Tile #4</strong></p><div class="tile-inner4"></div>
        <br>
        <p><strong>Tile #8</strong></p><div class="tile-inner8"></div>
        <br>
        <p><strong>Tile #16</strong></p><div class="tile-inner16"></div>
        <br>
        <p><strong>Tile #32</strong></p><div class="tile-inner32"></div>
        <br>
        <p><strong>Tile #64</strong></p><div class="tile-inner64"></div>
        <br>
        <p><strong>Tile #128</strong></p><div class="tile-inner128"></div>
        <br>
        <p><strong>Tile #256</strong></p><div class="tile-inner256"></div>
        <br>
        <p><strong>Tile #512</strong></p><div class="tile-inner512"></div>
        <br>
        <p><strong>Tile #1024</strong></p><div class="tile-inner1024"></div>
        <br>
        <p><strong>Tile #2048</strong></p><div class="tile-inner2048"></div>
        <hr>
        
            <h1> Change Images </h1>
        <div class="saved-games"></div>
            <div class="sam game-explanation container-flex">
                <br>
                <p> Image for 2 </p>
                <textarea class='input2' placeholder='www.starwars.com/darkvader.png'></textarea>
                <br>
                <p> Image for 4 </p>
                <textarea class='input4' placeholder='www.starwars.com/lukeskywalker.png'></textarea>
                <br>
                <p> Image for 8 </p>
                <textarea class='input8' placeholder='www.starwars.com/yoda.png'></textarea>
                <br>
                <p> Image for 16 </p>
                <textarea class='input16' placeholder='www.starwars.com/samtheevil.png'></textarea>
                <br>
                <p> Image for 32 </p>
                <textarea class='input32' placeholder='www.starwars.com/aidanthehacker.png'></textarea>
                <br>
                <p> Image for 64 </p>
                <textarea class='input64' placeholder='www.starwars.com/urmom.png'></textarea>
                <br>
                <p> Image for 128 </p>
                <textarea class='input128' placeholder='www.starwars.com/urdad.png'></textarea>
                <br>
                <p> Image for 256 </p>
                <textarea class='input256' placeholder='www.starwars.com/ursister1.png'></textarea>
                <br>
                <p> Image for 512 </p>
                <textarea class='input512' placeholder='www.starwars.com/ursister2.png'></textarea>
                <br>
                <p> Image for 1024 </p>
                <textarea class='input1024' placeholder='www.starwars.com/urbrother1.png'></textarea>
                <br>
                <p> Image for 2048 </p>
                <textarea class='input2048' placeholder='www.starwars.com/urbrother2_aidan_ur_awesome_sam_keep_doing_you.png'></textarea>
                <br>
                <p>Name this Game</p>
                <textarea class='nameGame' placeholder='star wars game'></textarea>
                <br>
                <a class="go">Submit</a>
                <br>
                <br>
            </div> -->
        </div>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:700,600' rel='stylesheet' type='text/css'>
        <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

 

        <script>
        </script>
        <script src="js/change.js"></script>
        <script src="js/bind_polyfill.js"></script>
        <script src="js/classlist_polyfill.js"></script>
        <script src="js/animframe_polyfill.js"></script>
        <script src="js/keyboard_input_manager.js"></script>
        <script src="js/html_actuator.js"></script>
        <script src="js/grid.js"></script>
        <script src="js/tile.js"></script>
        <script src="js/local_storage_manager.js"></script>
        <script src="js/game_manager.js"></script>
    <!-- after your other core scripts, but before application.js -->
<script src="js/url_theme.js"></script>
<script>
  // Read ?tile2=…&tile4=… etc. and store in window.customTileImages
  window.UrlTheme && window.UrlTheme.applyFromLocation();
</script>

<!-- keep the existing application startup after this -->
<script src="js/application.js"></script>
    

  <!-- ===== Share / Link Generator (bottom of page) ===== -->
  <style>
    .share-section{max-width:720px;margin:24px auto 40px;padding:16px;border:1px solid #ddd;border-radius:8px;font-family:inherit}
    .share-grid{display:grid;grid-template-columns:80px 1fr;gap:8px 12px;align-items:center}
    .share-row{display:contents}
    .share-row input[type="text"]{width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;font-family:inherit}
    .share-output{display:flex;gap:8px;margin-top:12px}
    .share-output input{flex:1;padding:8px;border:1px solid #bbb;border-radius:4px;font-family:inherit}
    .share-actions{display:flex;gap:10px;align-items:center;margin-top:8px}
    .share-actions button{padding:6px 10px;border:1px solid #888;border-radius:4px;background:#f7f7f7;cursor:pointer}
    .share-actions a{word-break:break-all}
    .share-heading{font-weight:600;margin:0 0 8px}
    .share-sub{color:#666;margin:0 0 12px}
    @media (max-width:560px){.share-grid{grid-template-columns:1fr}.share-grid label{margin-top:8px}}
  </style>

  <div class="share-section">
    <p class="share-heading">Create your own custom 2048 game</p>
    <p class="share-sub">Enter a name and any tile image URLs. Use a separate image host platform, such as freeimage.host, and paste the direct links to the image (right click and hit "Open image in new tab"). Note that this website does not SAVE any images, but instead pulls them from the host website. Use your custom URL to access games that you've created.</p>
    <form id="share-form" class="share-grid" onsubmit="return false;">
      <div class="share-row">
        <label for="share-name">Name</label>
        <input id="share-name" type="text" placeholder="e.g., My Cute Cats Set">
      </div>
      <!-- Tile URL fields -->
      <div class="share-row"><label for="url-2">tile2</label><input id="url-2" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-4">tile4</label><input id="url-4" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-8">tile8</label><input id="url-8" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-16">tile16</label><input id="url-16" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-32">tile32</label><input id="url-32" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-64">tile64</label><input id="url-64" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-128">tile128</label><input id="url-128" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-256">tile256</label><input id="url-256" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-512">tile512</label><input id="url-512" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-1024">tile1024</label><input id="url-1024" type="text" placeholder="https://..."></div>
      <div class="share-row"><label for="url-2048">tile2048</label><input id="url-2048" type="text" placeholder="https://..."></div>
        <!-- Show numbers toggle -->
        <div class="share-row">
          <label for="share-nums">Show tile numbers</label>
          <input id="share-nums" type="checkbox" checked>
        </div>
    </form>
    <div class="share-output">
      <input id="share-output" type="text" readonly>
      <button id="share-copy" type="button">Copy</button>
    </div>
    <div class="share-actions">
      <a id="share-anchor" href="#" target="_blank" rel="noopener">Open this custom game</a>
    </div>
      <p class="game-explanation">
                <strong class="important">How to play:</strong> Use your <strong>arrow keys</strong> to move the tiles. When two tiles with the same picture touch, they <strong>merge into one!</strong>
            </p>
            <hr>
            <p>
                Edited by <a href="http://github.com/cdivry">Clément DIVRY</a> to make this game use pictures.
                <br /> Forked from a AidanSpeakss adaptation of a <a href="http://gabrielecirulli.com" target="_blank">Gabriele Cirulli</a> project hosted <a href="http://github.com/gabrielecirulli/2048">here</a>, Based on <a href="https://itunes.apple.com/us/app/1024!/id823499224" target="_blank">1024 by Veewo Studio</a> and conceptually similar to <a href="http://asherv.com/threes/" target="_blank">Threes by Asher Vollmer.</a>
            </p>
        
  </div>

  <script src="js/share_link.js"></script>

<script>
  (function () {
    function setDisplayName(name) {
      var box = document.getElementById('custom-name');
      if (!box) return;
      name = (name || '').trim();
      box.textContent = name;
      box.style.display = name ? 'block' : 'none';
    }

    // On load: read from ?name=
    var params = new URLSearchParams(location.search);
    setDisplayName(params.get('name'));

    // If you’re using the link generator UI, update live as the user types
    var nameInput = document.getElementById('share-name');
    if (nameInput) {
      nameInput.addEventListener('input', function () {
        setDisplayName(nameInput.value);
      });
    }
  })();
</script>

    <script>
  // When the "New Game" button is clicked, simulate pressing the "R" key
  document.addEventListener('click', function (e) {
    if (!e.target) return;
    // Change selectors if your button has a different class or ID
    if (
      e.target.matches('.retry-button') ||
      e.target.matches('.restart-button')
    ) {
      e.preventDefault();

      // Fire R key logic directly if available
      var gm = window.gameManager;
      if (gm && typeof gm.restart === 'function') {
        gm.restart(e);
        return;
      }

      // Otherwise, dispatch a keydown for 'R'
      var event = new KeyboardEvent('keydown', {
        key: 'r',
        keyCode: 82,
        code: 'KeyR',
        which: 82,
        bubbles: true,
      });
      document.dispatchEvent(event);
    }
  });
</script>

<script>
  (function () {
    var KEY = 'byo2048-theme';
    var checkbox = document.getElementById('theme-switch');
    var label = document.getElementById('theme-label');

    function applyTheme(mode) {
      document.documentElement.setAttribute('data-theme', mode);
      if (checkbox) checkbox.checked = (mode === 'dark');
      if (label) label.textContent = (mode === 'dark' ? 'Dark' : 'Light');
      try { localStorage.setItem(KEY, mode); } catch (e) {}
      // Also tint the browser UI for PWA-ish feel:
      var meta = document.querySelector('meta[name="theme-color"]');
      if (meta) meta.setAttribute('content', mode === 'dark' ? '#121212' : '#ffffff');
    }

    // On load: prefer stored theme; else prefers-color-scheme; else light
    var saved = null;
    try { saved = localStorage.getItem(KEY); } catch (e) {}
    var preferred = saved || (window.matchMedia &&
                    window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(preferred);

    if (checkbox) {
      checkbox.addEventListener('change', function () {
        applyTheme(checkbox.checked ? 'dark' : 'light');
      });
    }
  })();
</script>

<script>
  (function () {
    function fitBoardToViewport() {
      var root = document.documentElement;
      var board = document.querySelector('.game-container');
      if (!board) return;

      // Read current gutter (defaults to 8px if not set)
      var cs = getComputedStyle(root);
      var gutter = parseFloat(cs.getPropertyValue('--gutter')) || 8;

      var vw = window.innerWidth;
      var vh = window.innerHeight;

      // Distance from top of viewport to the top edge of the board (includes header/scores)
      var topToBoard = board.getBoundingClientRect().top;

      // Board must fit within width gutters AND the remaining vertical space
      var maxByWidth  = vw - gutter * 2;
      var maxByHeight = vh - topToBoard - gutter;

      // Guard against negatives; floor to whole pixels for crispness
      var size = Math.max(0, Math.min(maxByWidth, maxByHeight)) | 0;

      // Expose to CSS
      root.style.setProperty('--board-size-dyn', size + 'px');
    }

    // Run on load and on resize/orientation changes.
    window.addEventListener('resize', fitBoardToViewport, { passive: true });
    window.addEventListener('orientationchange', fitBoardToViewport);

    // Run after layout paints (handles webfonts / header wrapping)
    document.addEventListener('DOMContentLoaded', function () {
      fitBoardToViewport();
      // A couple of post-load passes to catch late layout shifts
      setTimeout(fitBoardToViewport, 0);
      setTimeout(fitBoardToViewport, 250);
      setTimeout(fitBoardToViewport, 1000);
    });
  })();
</script>

<script>
  (function () {
    var root = document.documentElement;
    var params = new URLSearchParams(location.search);
    var checkbox = document.getElementById('share-nums');
    var out = document.getElementById('share-output');   // text field showing the custom URL
    var link = document.getElementById('share-anchor');   // "Open this custom game" link

    function setVisibility(show) {
      root.setAttribute('data-show-nums', show ? '1' : '0');
    }

    function setParamOnUrlString(urlString, show) {
      try {
        var u = new URL(urlString, location.origin);
        u.searchParams.set('nums', show ? '1' : '0');
        return u.toString();
      } catch (e) {
        return urlString; // if it's empty or not a full URL yet, leave it
      }
    }

    function updateShareWidgets() {
      if (out && out.value) out.value = setParamOnUrlString(out.value, checkbox.checked);
      if (link && link.getAttribute('href')) {
        link.setAttribute('href', setParamOnUrlString(link.getAttribute('href'), checkbox.checked));
      }
    }

    // 1) Initialize from URL (?nums=1/0). Default to ON if not present.
    var initial = params.get('nums');
    var show = (initial === null) ? true : initial !== '0';
    setVisibility(show);
    if (checkbox) checkbox.checked = show;

    // 2) Keep the page URL in sync when user clicks the checkbox (no reload).
    if (checkbox) {
      checkbox.addEventListener('change', function () {
        var showNow = checkbox.checked;
        setVisibility(showNow);

        var cur = new URL(location.href);
        cur.searchParams.set('nums', showNow ? '1' : '0');
        history.replaceState(null, '', cur.toString());

        updateShareWidgets();
      });
    }

    // 3) Whenever the generator updates the custom URL/link, append the nums param too.
    //    We listen to changes on the form and the output field so we piggyback on your existing generator logic.
    var form = document.getElementById('share-form');
    if (form) {
      form.addEventListener('input', updateShareWidgets);
      form.addEventListener('change', updateShareWidgets);
    }
    if (out) {
      out.addEventListener('input', updateShareWidgets);
      // Run once at load (in case a URL is prefilled)
      setTimeout(updateShareWidgets, 0);
    }
  })();
</script>

    
</body>

</html>
